#### 组件背景

- 由于 APP 内不在提供原生的Header,需要H5端自定义实现

#### 组件功能
- 在 APP 环境下添加自定义的H5头部 (此处有开关, 资源位控制)
- 给H5页面添加具有<返回><刷新><分享>功能的Header
- 过滤不需要添加头部的页面
- 内嵌的H5页面不添加自定义头部(连接上带有isEmbed属性)
- 添加包含分享功能的页面
- 在开发环境下所有页面默认添加头部，方便开发者编写样式代码时，对样式进行兼容

#### 组件使用规范

1. 安装

```bash
npm i @wanwu/add-app-header
```

2. 引入

```js
import { addAppHeader } from '@wanwu/add-app-header'
```
3. 导出
```js
export {
    addAppHeader:(param)=>VueComponent,
    appHeader:VueComponent,
    AppHeader:VueComponentOptions,
    isDevelopment:boolean,
    isAPP:boolean,
    isEmbed:boolean,
    needShowAppHeader:boolean,
    checkHasPath:(pathConfigArray, path)=>boolean
};
```
3. 使用规则

**在vue router 的beforeEach 生命周期内调用 addAppHeader 方法**

```js
router.beforeEach((to, from, next) => {
    addAppHeader({ path: to.path, hasSharePath, ignoreHeaderPath });
});
```

**将当前页面的分享方法注册到全局(不要忘了卸载该方法，每个页面的shareConfig都不同)**
```js
export default {
    deactivated() {
       window.commonShareClick = null;
    },
    destoryed() {
       window.commonShareClick = null;
    },
    mounted() {
       window.commonShareClick = this.shareClick;
    },
}
```

**方法调用时的参数说明**

| 参数             | 类型                         | 说明     |
| ---------------- | ---------------------------- | -------- |
| param | <code>object</code> | 参数 |
| param.path | <code>string</code> | 路径（一般是当前路径） |
| param.hasSharePath | <code>Array.&lt;string&gt;</code> | 需要展示分享按钮的路径规则正则字符串数组 |
| param.ignoreHeaderPath | <code>Array.&lt;string&gt;</code> | 不需要展示头部的路径规则正则字符串数组 |
| param.props | <code>object</code> | addHeader props属性 |
| param.events | <code>object</code> | addHeader 事件 |
| param.slots | <code>object</code> | addHeader 插槽  参照 [文档](https://cn.vuejs.org/v2/guide/render-function.html#%E6%8F%92%E6%A7%BD) 中的JSX关于插槽的语法|

**单独作为组件引入**
```html
<template>
<div>
    <AppHeader ref="AppHeader"></AppHeader>
</div>
</template>
<script>
import { AppHeader } from '@wanwu/add-app-header';

export default {
    components: { AppHeader },
    mounted(){
        // 如果你需要头部占位高度
        this.$refs.AppHeader.setPublicHeaderHeight()
    }
}
</script>
```

**作为组件引入的参数说明**

|props|描述|类型|是否必填|默认值|
|---|---|---|---|---|
|top|默认占位，实现原生APP内的头部效果 针对店铺首页shop/index进行absolute定位处理|`Number` /  `String`|`false`|-|
|custom|是否自定义 -- 1.是：无背景，无nh，使用自定义top 2. 否：有背景，有nh，不使用自定义top|`Boolean`|`false`|false|
|showTitle|是否展示documentTitle|`Boolean`|`false`|true|
|titleColor|title 样式更改|`String`|`false`|-|
|showShare|是否展示分享按钮|`Boolean`|`false`|false|
|showAppHeader|组件使用的header隐藏显示|`Boolean`|`false`|false|
|topBg|自定义头部背景|`String`|`false`|-|
|nhBgColor|nh高度背景|`String`|`false`|#fff|
|initShow|是否需要出示显示（强制，给九宫用的，其他场景不建议使用）|`boolean`|`false`|-|
|headerBtn|按钮配置|`Object`|`false`|-|
|headerBtn.back|返回按钮配置|`Object`|`false`|`{icon: 'ww-icon-fanhui',show: true,}`|
|headerBtn.title|标题配置|`Object`|`false`|`{title: document.title,show: true,}`|
|headerBtn.refresh|刷新按钮配置|`Object`|`false`|`{icon: 'ww-icon-shuaxin',show: true,}`|
|headerBtn.share|分享按钮配置|`Object`|`false`|`{icon: 'ww-icon-fenxiang',show: false}`|
|headerStyle|appHeader组件根元素的样式|`Object`|`false`|-|

**组件插槽**
|Name|Description|Default Slot Content|
|---|---|---|
|back|返回按钮位置插槽|返回按钮|
|title|页面标题位置插槽|标题|
|refresh|刷新按钮位置插槽|刷新按钮|
|share|分享按钮位置插槽|分享按钮|

**组件Events**

| 事件名 | 说明 | 回调参数 |
|------|------|------|
| back | 用户点击返回图标 | - |
| refresh | 用户点击刷新图标 | - |
| share | 用户点击分享图标 | - |

> 页面内修改appHeader配置，在下次调用后会被重置（大部分项目中都会在路由生命周期中调用而重置）
```js
import {addAppHeader} from '@wanwu/add-app-header';
export default {
    activated(){
        addAppHeader({
            events:{
                back: () => {
                    console.log('back');
                },
                refresh: () => {
                    console.log('refresh');
                },
                share: () => {
                    console.log('share');
                },
            },
            props:{
                custom:true,
                topBg: 'red',
            },
            slots:{
                back:()=>{
                    return (
                        <a>返回</a>
                    )
                }
            }
        })
    }
}
```

**暴露给外部的方法**
- showAppHeaderShare 展示分享按钮/拥有分享功能
- hideAppHeaderShare 隐藏分享按钮/拥有分享功能


**checkHasPath(pathConfigArray, path)**
公用校验路径的方法

**Kind**: global function

| Param | Type | Description |
| --- | --- | --- |
| pathConfigArray | <code>Array.&lt;string&gt;</code> \| <code>Array.&lt;RegExp&gt;</code> | 路径规则（正则字符串）数组 |
| path | <code>string</code> | 待校验的路径字符串 |


### CHANGELOG
+ `1.0.90`  更新日期：2021-04-27，更新者：慕辰
   1. 修改九宫页面部分手机的底部白线条的问题
+ `1.0.89`  更新日期：2021-03-23，更新者：六谷
   1. 修改一些判断，版本控制时将wwdz_b2b（收藏集市）排除在外
