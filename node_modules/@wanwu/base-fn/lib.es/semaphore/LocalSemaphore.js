import { DEFAULT_LOCKER_NAME } from "./Canstant";
import AbstractSemaphore from "./AbstractSemaphore";
/**
 * 单实例信号量
 * 用实例变量来维持permits的数量
 */
export default class LocalSemaphore extends AbstractSemaphore {
    constructor(permits, name = DEFAULT_LOCKER_NAME, fair = false) {
        super(name, fair);
        this.permits = permits;
        this.leftPermits = permits;
    }
    doAcquire(permits) {
        if (this.leftPermits >= permits) {
            this.leftPermits = this.leftPermits - permits;
            // @ts-ignore
            return Promise.resolve(true);
        }
        else {
            // @ts-ignore
            return Promise.resolve(false);
        }
    }
    doRelease(permits) {
        this.leftPermits += permits;
        // @ts-ignore
        return Promise.resolve(true);
    }
}
