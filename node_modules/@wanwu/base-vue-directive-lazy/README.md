## directive-lazy 图片懒加载指令

### 导出方式

```js
export {
    getLazyFn,
};
export default {
    install(Vue, options) {
        const lazy = getLazyFn(options);
        // Vue自定义指令，lazy为指令的名称
        Vue.directive('lazy', lazy);
    },
};
```
### 引入

``` javascript
// vue全局插件式引入
import Vue from 'vue';
import lazy from '@wanwu/base-vue-directive-lazy';
Vue.use(lazy, {
    // 2.1.1版本之后不再使用
    // loading:
    //     'https://cdn.wanwudezhi.com/static/web-static/image/1cfb810cf69db4ea0e0bb3d7a64b71c6_555x555.png',
    // error:
    //     'https://cdn.wanwudezhi.com/static/web-static/image/fdaa64918a5a15e53fc1a87c9d870e61_555x555.png',
});


// vue局部组件注册指令
import {
    getLazyFn,
} from '@wanwu/base-vue-directive-lazy';
const lazy = getLazyFn({
    // 2.1.1版本之后不再使用
    // loading:
    //     'https://cdn.wanwudezhi.com/seller-admin/image/MTU1NDk2MjkxNzI2Nw==.png',
    // error:
    //     'https://cdn.wanwudezhi.com/seller-admin/image/MTU1NDk2Mjk3MzczMw==.png',
});

export default {
    name: 'Comp',
    directives: {
        lazy,
    },
}
```
## 代码演示

### 基础用法

```html
<img v-lazy:[size].container="img"></img>
```

## API

### options // vue.use 可传入的参数

| 参数 | 说明 | 类型 | 默认值 | 版本 |
|------|------|------|------|------|
| loading | 加载中图片 | *string* | `'https://cdn.wanwudezhi.com/static/web-static/image/5dc5f4919f413689b14dcd58b48d81f9.png'` | 2.1.1版本之后不再使用 |
| error | 加载失败图片 | *string* | `'https://cdn.wanwudezhi.com/static/web-static/image/5dc5f4919f413689b14dcd58b48d81f9.png'` | 2.1.1版本之后不再使用 |
| preLoad | 预加载距离系数 | *number* | `2` | - |
| listenEvents | 监听的容器事件 | *array* | `['scroll','wheel','mousewheel','resize','animationend','transitionend','touchmove']` | - |
| imgKey | 指定兜底图 | *string* | `wwdz,common` | 2.1.2新增 |

### 指令参数  // v-lazy:[argument].modifiers="value"

| 参数种类 | 参数 | 说明 | 类型 | 默认值 | 版本 |
|------|------|------|------|------|------|
| argument | size | 图片尺寸，根据图片尺寸裁剪兜底图，`{width,height}` | *object* | - | - |
| modifiers | container | 容器的ref名称或id,只取第一个 | *string* | - | - |
| value | value | 图片`src`或者`{width,height,url}` | *string|object* | - | - |


### CHANGELOG

+ `2.1.6`  更新日期：2021-10-11，更新者：六谷
   1. 兜底图片样式统一
+ `2.1.5`  更新日期：2021-03-24，更新者：六谷
   1. imgKey(wwdz/common)支持对接wanwuConfig(base-fn)中的统一配置，被覆盖的顺序为：wanwuConfig < query < options
+ `2.1.2`  更新日期：2020-12-2，更新者：天青
   1. 新增了一套兜底图，通用型风格，不带wwdz标识
   2. 初始化时判断url内是存在`hidewwdz=1`,存在时赋值`window.hidewwdz=true`
   3. 新增参数`options.imgKey` 可指定一套兜底图，当前支持`wwdz、common`
+ `2.1.1`  更新日期：0610，更新者：锦阳
    1. 懒加载默认加载图和错误图由当前包统一维护，不再获取options里面的loading和error
    2. 支持在不传size的情况下，从图片cdn链接上获取图片原始的宽高，优化初始加载体验
    3. 把图片的`src`设置到元素的`data-src`属性上，方便排查错误
