<template>
    <popup
        :value="value"
        class="components__toast toast"
        :overlay="mask"
        :close-on-click-overlay="closeOnClickOverlay"
        :position="position"
        :slot-style="{ zIndex:'4001' }"
        @input="onInput"
        @closed="closed($event)"
    >
        <div
            class="toast__content"
            :style="contentStyle"
            :class="contentClass"
        >
            <slot>{{ message }}</slot>
        </div>
    </popup>
</template>
<script>
    import popup from '@wanwu/base-vue-popup';
    export default {
        name: 'Toast',
        components: {
            popup,
        },
        props: {
            value: {
                type: Boolean,
                default: false,
            },
            message: {
                type: String,
                default: '',
            },
            mask: {
                type: Boolean,
                default: false,
            },
            closeOnClickOverlay: {
                type: Boolean,
                default: false,
            },
            position: {
                type: String,
                default: '',
            },
            duration: {
                type: Number,
                default: 1500,
            },
            contentStyle: {
                type: [
                    Object,
                    String,
                ],
            },
            contentClass: {
                type: [
                    Object,
                    String,
                ],
            },
            callback: {
                type: Function,
            },
        },
        data() {
            return {
                timer: null,
            };
        },
        watch: {
            value(val) {
                this.show = val;
                this.autoClose();
            },
        },
        created() {
            this.autoClose();
        },
        methods: {
            close() {
                this.onInput(false);
                this.$emit('close');
                this.callback && this.callback();
            },
            closed() {
                this.$emit('closed');
            },
            autoClose() {
                if (this.timer) {
                    clearTimeout(this.timer);
                }
                if (this.value && this.duration) {
                    this.timer = setTimeout(() => {
                        this.close();
                    }, this.duration);
                }
            },
            onInput(val) {
                this.$emit('input', val);
            },
        },
    };
</script>
<style lang="less" scoped>
.toast__content {
    padding: 30px;

    /* min-width: 180px; */
    background-color: rgba(50, 50, 51, 0.88);
    color: #fff;
    font-size: 26px;
    line-height: 40px;
    border-radius: 16px;
    justify-content: center;
    text-align: center;
    max-width: 680px;
    white-space: normal;
    overflow: hidden;
}
</style>
