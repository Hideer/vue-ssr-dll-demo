<a name="module_User"></a>

## User
用户方法集


* [User](#module_User)
    * [module.exports](#exp_module_User--module.exports) ⏏
        * _static_
            * [.User](#module_User--module.exports.User)
                * [new exports.User()](#new_module_User--module.exports.User_new)
                * [.option](#module_User--module.exports.User+option)
                * [.getToken()](#module_User--module.exports.User+getToken) ⇒ <code>string</code>
                * [.setOption(option)](#module_User--module.exports.User+setOption)
                * [.updateToken()](#module_User--module.exports.User+updateToken) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.ensureLogin()](#module_User--module.exports.User+ensureLogin) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.ensureLoginNoLogin()](#module_User--module.exports.User+ensureLoginNoLogin) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.updateUserInfo(skipLogin)](#module_User--module.exports.User+updateUserInfo) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.loginByCode(code, inviteCode)](#module_User--module.exports.User+loginByCode) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.loginByPhone(phone, code)](#module_User--module.exports.User+loginByPhone) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.setUpUserInfo(userInfo)](#module_User--module.exports.User+setUpUserInfo) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.getWxAppMap()](#module_User--module.exports.User+getWxAppMap) ⇒ <code>Promise.&lt;wxAppMap&gt;</code>
                * [.getWxAppId()](#module_User--module.exports.User+getWxAppId) ⇒ <code>Promise.&lt;string&gt;</code>
                * [.getWxAppType()](#module_User--module.exports.User+getWxAppType) ⇒ <code>Promise.&lt;number&gt;</code>
                * [.updatePhone(phone, code)](#module_User--module.exports.User+updatePhone) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.clearUserInfo()](#module_User--module.exports.User+clearUserInfo)
                * [.goToLogin(params)](#module_User--module.exports.User+goToLogin) ⇒ <code>Promise.&lt;void&gt;</code>
                * [.getOpenId()](#module_User--module.exports.User+getOpenId) ⇒ <code>string</code> \| <code>null</code>
                * [.saveUserInfo(userInfo)](#module_User--module.exports.User+saveUserInfo)
                * [.getUserInfo()](#module_User--module.exports.User+getUserInfo) ⇒ <code>userInfo</code>
                * [.ensureGetUserInfo()](#module_User--module.exports.User+ensureGetUserInfo) ⇒ <code>Promise.&lt;userInfo&gt;</code>
                * [.removeUserInfo()](#module_User--module.exports.User+removeUserInfo)
                * [.redirectBack()](#module_User--module.exports.User+redirectBack)
        * _inner_
            * [~option](#module_User--module.exports..option) : <code>Object</code>
            * [~userInfo](#module_User--module.exports..userInfo) : <code>Object</code>
            * [~wxAppMap](#module_User--module.exports..wxAppMap) : <code>Object</code>

<a name="exp_module_User--module.exports"></a>

### module.exports ⏏
{User} 默认导出用户模块实例

**Kind**: Exported member
<a name="module_User--module.exports.User"></a>

#### module.exports.User
**Kind**: static class of [<code>module.exports</code>](#exp_module_User--module.exports)

* [.User](#module_User--module.exports.User)
    * [new exports.User()](#new_module_User--module.exports.User_new)
    * [.option](#module_User--module.exports.User+option)
    * [.getToken()](#module_User--module.exports.User+getToken) ⇒ <code>string</code>
    * [.setOption(option)](#module_User--module.exports.User+setOption)
    * [.updateToken()](#module_User--module.exports.User+updateToken) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.ensureLogin()](#module_User--module.exports.User+ensureLogin) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.ensureLoginNoLogin()](#module_User--module.exports.User+ensureLoginNoLogin) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.updateUserInfo(skipLogin)](#module_User--module.exports.User+updateUserInfo) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.loginByCode(code, inviteCode)](#module_User--module.exports.User+loginByCode) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.loginByPhone(phone, code)](#module_User--module.exports.User+loginByPhone) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.setUpUserInfo(userInfo)](#module_User--module.exports.User+setUpUserInfo) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.getWxAppMap()](#module_User--module.exports.User+getWxAppMap) ⇒ <code>Promise.&lt;wxAppMap&gt;</code>
    * [.getWxAppId()](#module_User--module.exports.User+getWxAppId) ⇒ <code>Promise.&lt;string&gt;</code>
    * [.getWxAppType()](#module_User--module.exports.User+getWxAppType) ⇒ <code>Promise.&lt;number&gt;</code>
    * [.updatePhone(phone, code)](#module_User--module.exports.User+updatePhone) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.clearUserInfo()](#module_User--module.exports.User+clearUserInfo)
    * [.goToLogin(params)](#module_User--module.exports.User+goToLogin) ⇒ <code>Promise.&lt;void&gt;</code>
    * [.getOpenId()](#module_User--module.exports.User+getOpenId) ⇒ <code>string</code> \| <code>null</code>
    * [.saveUserInfo(userInfo)](#module_User--module.exports.User+saveUserInfo)
    * [.getUserInfo()](#module_User--module.exports.User+getUserInfo) ⇒ <code>userInfo</code>
    * [.ensureGetUserInfo()](#module_User--module.exports.User+ensureGetUserInfo) ⇒ <code>Promise.&lt;userInfo&gt;</code>
    * [.removeUserInfo()](#module_User--module.exports.User+removeUserInfo)
    * [.redirectBack()](#module_User--module.exports.User+redirectBack)

<a name="new_module_User--module.exports.User_new"></a>

##### new exports.User()
用户相关方法集

<a name="module_User--module.exports.User+option"></a>

##### user.option
**Kind**: instance property of [<code>User</code>](#module_User--module.exports.User)
**Properties**

| Name | Type |
| --- | --- |
| 模块全局配置 | <code>option</code> |

<a name="module_User--module.exports.User+getToken"></a>

##### user.getToken() ⇒ <code>string</code>
获取用户token

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+setOption"></a>

##### user.setOption(option)
批量修改模块全局配置，使用merge

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Description |
| --- | --- | --- |
| option | <code>option</code> | 模块全局配置 |

<a name="module_User--module.exports.User+updateToken"></a>

##### user.updateToken() ⇒ <code>Promise.&lt;userInfo&gt;</code>
更新用户token

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+ensureLogin"></a>

##### user.ensureLogin() ⇒ <code>Promise.&lt;userInfo&gt;</code>
确保登录，未登录调用登录

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+ensureLoginNoLogin"></a>

##### user.ensureLoginNoLogin() ⇒ <code>Promise.&lt;userInfo&gt;</code>
确保登录，未登录不调用登录

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+updateUserInfo"></a>

##### user.updateUserInfo(skipLogin) ⇒ <code>Promise.&lt;userInfo&gt;</code>
更新用户信息

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| skipLogin | <code>boolean</code> | <code>false</code> | 未登录是否要去登录 |

<a name="module_User--module.exports.User+loginByCode"></a>

##### user.loginByCode(code, inviteCode) ⇒ <code>Promise.&lt;userInfo&gt;</code>
使用微信授权码登录

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Description |
| --- | --- | --- |
| code | <code>number</code> | 微信授权码 |
| inviteCode | <code>number</code> | 邀请码 |

<a name="module_User--module.exports.User+loginByPhone"></a>

##### user.loginByPhone(phone, code) ⇒ <code>Promise.&lt;userInfo&gt;</code>
手机号登录

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Description |
| --- | --- | --- |
| phone | <code>number</code> | 手机号 |
| code | <code>number</code> | 短信验证码 |

<a name="module_User--module.exports.User+setUpUserInfo"></a>

##### user.setUpUserInfo(userInfo) ⇒ <code>Promise.&lt;userInfo&gt;</code>
校验并返回用户信息

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Description |
| --- | --- | --- |
| userInfo | <code>userInfo</code> | 用户信息 |

<a name="module_User--module.exports.User+getWxAppMap"></a>

##### user.getWxAppMap() ⇒ <code>Promise.&lt;wxAppMap&gt;</code>
获取微信公众号相关的配置

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+getWxAppId"></a>

##### user.getWxAppId() ⇒ <code>Promise.&lt;string&gt;</code>
获取微信公众号AppId

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+getWxAppType"></a>

##### user.getWxAppType() ⇒ <code>Promise.&lt;number&gt;</code>
获取微信公众号类型

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+updatePhone"></a>

##### user.updatePhone(phone, code) ⇒ <code>Promise.&lt;userInfo&gt;</code>
绑定手机号

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Description |
| --- | --- | --- |
| phone | <code>number</code> | 手机号 |
| code | <code>number</code> | 短信验证码 |

<a name="module_User--module.exports.User+clearUserInfo"></a>

##### user.clearUserInfo()
清除本地缓存中的用户信息和token

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+goToLogin"></a>

##### user.goToLogin(params) ⇒ <code>Promise.&lt;void&gt;</code>
调用登录页面

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Description |
| --- | --- | --- |
| params | <code>any</code> | 登录页参数 |

<a name="module_User--module.exports.User+getOpenId"></a>

##### user.getOpenId() ⇒ <code>string</code> \| <code>null</code>
获取openId

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+saveUserInfo"></a>

##### user.saveUserInfo(userInfo)
保存用户信息

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)

| Param | Type | Description |
| --- | --- | --- |
| userInfo | <code>userInfo</code> | 用户信息 |

<a name="module_User--module.exports.User+getUserInfo"></a>

##### user.getUserInfo() ⇒ <code>userInfo</code>
获取用户信息

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+ensureGetUserInfo"></a>

##### user.ensureGetUserInfo() ⇒ <code>Promise.&lt;userInfo&gt;</code>
异步的确保获取到用户信息（异步时序问题，不会强制调登录）

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+removeUserInfo"></a>

##### user.removeUserInfo()
删除用户信息缓存

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports.User+redirectBack"></a>

##### user.redirectBack()
登录页面回跳方法

**Kind**: instance method of [<code>User</code>](#module_User--module.exports.User)
<a name="module_User--module.exports..option"></a>

#### module.exports~option : <code>Object</code>
用户模块配置选项

**Kind**: inner typedef of [<code>module.exports</code>](#exp_module_User--module.exports)
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| onError | <code>function</code> | 错误时的同一处理函数 |
| loginOption | <code>Object</code> | 登录配置 |
| loginOption.loginOrigin | <code>string</code> | 登录跳转对应的域名，默认值为` window.location.origin` |
| loginOption.loginByPhoneUrl | <code>string</code> | 手机号登录跳转对应的链接，默认值为`'/mall-web/user/bindPhone'` |
| loginOption.wechatTransformUrl | <code>string</code> | 微信登录回跳地址url，默认值为`'/mall-web/user/transform'` |
| loginOption.xcxLoginUrl | <code>string</code> | 微信小程序登录url，默认值为`'/pages/user/login'` |
| loginOption.getTokenOnUrl | <code>boolean</code> | 是否从url上获取token，默认值为`false` |

<a name="module_User--module.exports..userInfo"></a>

#### module.exports~userInfo : <code>Object</code>
用户信息

**Kind**: inner typedef of [<code>module.exports</code>](#exp_module_User--module.exports)
<a name="module_User--module.exports..wxAppMap"></a>

#### module.exports~wxAppMap : <code>Object</code>
微信公众号配置信息

**Kind**: inner typedef of [<code>module.exports</code>](#exp_module_User--module.exports)
**Properties**

| Name | Type | Description |
| --- | --- | --- |
| domain | <code>string</code> | 域名 |
| appId | <code>string</code> | 公众号appId |
| userAppId | <code>string</code> | 用户登录用appId |
| appType | <code>number</code> | 公众号类型 |


