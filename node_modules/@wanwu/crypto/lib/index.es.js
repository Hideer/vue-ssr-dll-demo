var _0x1cec=['MD5','abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789','floor','length','AES','encrypt','Utf8','enc','parse','mode','CBC','pad','Pkcs7','toString','setPublicKey','encode','HmacSHA256','Base64','join','split','decrypt','-----BEGIN\x20RSA\x20PRIVATE\x20KEY-----\x0aMIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAMnmRT1Ez9jjIxZjU9DIMHnEtJjOKgKcUhaFp9cG35bZ7IuK9h+t000FRf13X6llxHuGKzCYMJtqiRHA2n9RMX4unlGZ65qNphasYxCcxTdxbryAfJUrOzMi9KosMUKXE1pNnNNxGm+DlzoOKMYO2rdJLUJ8E0eMgdunFBGJ9AsxAgMBAAECgYBMqPZZUStqOrQz5/sHJzvgwGOiMYWaACjbDFyyNJXo/U3nnhfd5253rCzrFMxp0Y5NKKB1jxPFrynkZ8mO1hFoHq+Hjx9izgjJ7MqrBVMmT10FeTctvU1VQ2fEW/hDHeYklHQwymV5NAw6ZTrW9s5Qdc5JKv4N+eqwHZRpWsGAUQJBAPZWADu3H7VbFPdTXRiZzkhOjfUf7jRCZZ12jB/Ru3DoXzKJ+vtQCAv8vxyusmenCD+eyMkQXvZc935xNwDcHr8CQQDR0fxdL+RscMidWi+1u+/H2g1QA/uQ7VYijiCkv6p5u4TFJHyLH+uBQlnXyTVBq1u0l76yPMxGYwIdJkz8H0IPAkBJN2CUXyZ+idbeeBmokTZ9yVNqMxZi1AVN2wlk/7p9oaOB6v79KVlq7rGC/e2q3zuVZUV6dXI0OYeaPl5B1CsTAkAdtDqj/qm56GWeUSw78DVL98S2tTmiFNeC4NgiOrgpr7BmMHopQAWZMQmDEQsnFtlOwcTPeuf4dv/PnKJ9dvdlAkEAvRCK/xDZHzEgO3PUxoGA1dvwCUOrhrrQ0UcAO3oxswxLlWur2hr6dtuFIFpXcb3sEBtOoytPym0yTdUo/FT0aQ==\x0a-----END\x20RSA\x20PRIVATE\x20KEY-----','instance','setPrivateKey','sign'];(function(_0x240138,_0x5110b8){var _0x11321a=function(_0x14706d){while(--_0x14706d){_0x240138['push'](_0x240138['shift']());}};_0x11321a(++_0x5110b8);}(_0x1cec,0x1f0));var _0x378c=function(_0x574e08,_0x2df123){_0x574e08=_0x574e08-0x0;var _0x55157c=_0x1cec[_0x574e08];return _0x55157c;};import'core-js/modules/es.array.join';import'core-js/modules/es.date.to-string';import'core-js/modules/es.object.to-string';import'core-js/modules/es.regexp.exec';import'core-js/modules/es.regexp.to-string';import'core-js/modules/es.string.split';import _0x1cc956 from'@babel/runtime/helpers/esm/slicedToArray';import _0x271d42 from'crypto-js';import{Base64}from'js-base64';import _0x2bde82 from'jsencrypt';import _0x4002a1 from'@babel/runtime/helpers/esm/classCallCheck';import _0x4f3c58 from'@babel/runtime/helpers/esm/createClass';var rsaPrivateKey=_0x378c('0x0');var KlSignature=function(){function KlSignature(){_0x4002a1(this,KlSignature);this[_0x378c('0x1')]=new _0x2bde82();this[_0x378c('0x1')][_0x378c('0x2')](rsaPrivateKey);}_0x4f3c58(KlSignature,[{'key':_0x378c('0x2'),'value':function setPrivateKey(key){this[_0x378c('0x1')][_0x378c('0x2')](key);}},{'key':'sign','value':function sign(str){var signStr=this['instance'][_0x378c('0x3')](str,_0x271d42[_0x378c('0x4')],'md5');return signStr;}}]);return KlSignature;}();var _rsaPublicKey='-----BEGIN\x20PUBLIC\x20KEY-----\x0aMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDQ3rAXo+UYfUFy1xk4egQTpMZF\x0aAnWS7kTPUfTJic/GNyfUZqGrRDyXiFlkbtNWLHMEENY+5KDs7kLPWonfiBNvQ+3o\x0ajFOcM8spammymjn6pv3Q4fn2UpZ2rE98qSW3DUdIKd8UblYcT+SvjuIavre5eSNm\x0aEQhmknOhrM51UjCuxQIDAQAB\x0a-----END\x20PUBLIC\x20KEY-----\x0a';var _rsaPrivateKey='-----BEGIN\x20RSA\x20PRIVATE\x20KEY-----\x0aMIICeQIBADANBgkqhkiG9w0BAQEFAASCAmMwggJfAgEAAoGBANDesBej5Rh9QXLXGTh6BBOkxkUCdZLuRM9R9MmJz8Y3J9RmoatEPJeIWWRu01YscwQQ1j7koOzuQs9aid+IE29D7eiMU5wzyylqabKaOfqm/dDh+fZSlnasT3ypJbcNR0gp3xRuVhxP5K+O4hq+t7l5I2YRCGaSc6GsznVSMK7FAgMBAAECgYEAxOY40IBTlst1aGI3x1LXBwGdWy7fUXzGZz6WaWs98FjMdmGt5Ds2d4803gXPunu6jUml/rIetlxBpSFvucaYseRStGz9hRsk1i+nCASg33NnXF2K3vg+uKQMvihSqKJpfC5jECu0gokVSOix5I0v50M6KMScfC+/SGZJZsvGUh0CQQD92NAxYXqIItCG51ARxLMHhhtsBxramwu/xMznUi3bVdkP0fTTnSe0bcHSiIYfRvrqxbYjswEHqzayDGFZWMdjAkEA0qQ23+h45FsMw2prVeoCv/aKCRXQuDKkDK/N/1LBSJNIghboksJ6Bc3lYMehmKfEKoXDyeRImx2C/E8FOmdttwJBAK5dtLyGwd0rVOOlliluXK+JXeK5iqeoosxqSXmHyHoGISCtzqdhJvnX/rA4GTD417hWcMNa3RVAdUSeHmx6ABMCQQCp3hoOuZf8d9y0HrcOotey3Ov2ZaxbTyNyw7f5RlBu6a+YkUbfS4xB8Agh4vvTcr/ElvkMcFeJF+SQ+ly5+7zDAkEAlsvLFqdlFftlRc5BtZm7vU83EwSbOassrp/XkVDPeGhKvznyCmPTI7fV14+El9YTn6XC8JkK74+bn/DVo2/67A==\x0a-----END\x20RSA\x20PRIVATE\x20KEY-----\x0a';function getRandomChar(){var charset=_0x378c('0x5');var randomNum=Math[_0x378c('0x6')](Math['random']()*charset[_0x378c('0x7')]);return charset[randomNum];}function getRandomString(){var length=arguments[_0x378c('0x7')]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:0x0;var str='';for(var i=0x0;i<length;i++){str+=getRandomChar();}return str;}function encrypt(data){var rsaPublicKey=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:_rsaPublicKey;var version=arguments['length']>0x2&&arguments[0x2]!==undefined?arguments[0x2]:'wwdz_h5_1.0';var aesKey=getRandomString(0x20);var iv=getRandomString(0x10);var hmacKey=getRandomString(0x20);var encryptData=_0x271d42[_0x378c('0x8')][_0x378c('0x9')](data,_0x271d42['enc'][_0x378c('0xa')]['parse'](aesKey),{'iv':_0x271d42[_0x378c('0xb')][_0x378c('0xa')][_0x378c('0xc')](iv),'mode':_0x271d42[_0x378c('0xd')][_0x378c('0xe')],'padding':_0x271d42[_0x378c('0xf')][_0x378c('0x10')]})[_0x378c('0x11')]();var jSEncrypt=new _0x2bde82();jSEncrypt[_0x378c('0x12')](rsaPublicKey);var aesKeyCipher=jSEncrypt[_0x378c('0x9')](aesKey);var hmacKeyCipher=jSEncrypt['encrypt'](hmacKey);var ivCipher=Base64[_0x378c('0x13')](iv);var sign=_0x271d42[_0x378c('0x14')](ivCipher+'$'+encryptData,hmacKey)[_0x378c('0x11')](_0x271d42[_0x378c('0xb')][_0x378c('0x15')]);return[version,hmacKeyCipher,aesKeyCipher,ivCipher,encryptData,sign][_0x378c('0x16')]('$');}function decrypt(encryptStr,cipherText){var rsaPrivateKey=arguments[_0x378c('0x7')]>0x2&&arguments[0x2]!==undefined?arguments[0x2]:_rsaPrivateKey;if(encryptStr){var _encryptStr$split=encryptStr[_0x378c('0x17')]('$'),_encryptStr$split2=_0x1cc956(_encryptStr$split,0x6),version=_encryptStr$split2[0x0],hmacKeyCipher=_encryptStr$split2[0x1],aesKeyCipher=_encryptStr$split2[0x2],ivCipher=_encryptStr$split2[0x3],encryptData=_encryptStr$split2[0x4],sign=_encryptStr$split2[0x5];var jSEncrypt=new _0x2bde82();jSEncrypt[_0x378c('0x2')](rsaPrivateKey);var aesKey=jSEncrypt[_0x378c('0x18')](aesKeyCipher);var iv=Base64['decode'](ivCipher);var hmacKey=jSEncrypt[_0x378c('0x18')](hmacKeyCipher);var originData=_0x271d42[_0x378c('0x8')]['decrypt'](cipherText,_0x271d42[_0x378c('0xb')]['Utf8'][_0x378c('0xc')](aesKey),{'iv':_0x271d42[_0x378c('0xb')][_0x378c('0xa')][_0x378c('0xc')](iv),'mode':_0x271d42[_0x378c('0xd')][_0x378c('0xe')],'padding':_0x271d42[_0x378c('0xf')]['Pkcs7']})[_0x378c('0x11')](_0x271d42[_0x378c('0xb')]['Utf8']);var originSign=_0x271d42[_0x378c('0x14')](ivCipher+'$'+cipherText,hmacKey)[_0x378c('0x11')](_0x271d42[_0x378c('0xb')]['Base64']);if(originSign===sign){return originData;}else{return originData;}}}export{KlSignature,decrypt,encrypt};
