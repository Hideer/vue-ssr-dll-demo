# lazy-component 懒加载组件

### 引入

``` javascript
import LazyComponent from '@wanwu/base-vue-lazy-component';
// 全局注册
Vue.use(LazyComponent)
// OR
// 局部注册
export default {
    components:{
        LazyComponent,
    },
}
```

## 代码演示

> 懒加载组件理论上不应该被用户察觉，为了方便查看未加载状态，提供了点击切换状态的方法，实际使用不需要

### 基础用法

 
``` html
<template>
    <div class="wrapper flex f-fw-w">
        <LazyComponent
            v-for="index in 10"
            :key="index"
            :ref="`lazy__${index}`"
            :type="0"
            :height="516"
            :width="340"
            perch-class="item pre"
            class="item__wrapper"
            @click.native="onClick(index)"
        >
            <div
                :ref="`item__${index}`"
                class="item"
                v-text="`已加载元素：${index}`"
            ></div>
        </LazyComponent>
        <div
            v-for="index in 10"
            :ref="`item__${index}`"
            :key="index"
            class="item"
            v-text="`已加载元素：${index}`"
        ></div>
    </div>
</template>

<script>
    export default {
        name: 'Demo',
        components: {},
        methods: {
            onClick(index) {
                // 预览代码，无意义
                const lazyVm = this.$refs[`lazy__${index}`][0];
                if (lazyVm.state.loaded) {
                    lazyVm.recycle();
                } else {
                    lazyVm.load();
                }
            },
        },
    };
</script>
<style lang="less" scoped>
@import '../../style/index.less';
</style>

```
### 骨架屏或其他填充结构 skeleton插槽

 
``` html
<template>
    <div class="wrapper flex f-fw-w">
        <LazyComponent
            v-for="index in 10"
            :key="index"
            :ref="`lazy__${index}`"
            :type="0"
            :height="516"
            :width="340"
            perch-class="item pre"
            class="item__wrapper"
            @click.native="onClick(index)"
        >
            <div
                :ref="`item__${index}`"
                class="item"
                v-text="`已加载元素：${index}`"
            ></div>
            <div
                slot="skeleton"
                :ref="`item__${index}`"
                class="skeleton"
                v-text="`预加载填充：${index}`"
            ></div>
        </LazyComponent>
    </div>
</template>

<script>
    export default {
        name: 'Demo',
        components: {},
        methods: {
            onClick(index) {
                // 预览代码，无意义
                const lazyVm = this.$refs[`lazy__${index}`][0];
                if (lazyVm.state.loaded) {
                    lazyVm.recycle();
                    this.$refs[`item__${index}`][0].style.backgroundColor = '';
                } else {
                    lazyVm.load();
                }
            },
        },
    };
</script>
<style lang="less" scoped>
@import '../../style/index.less';
</style>

```


## API

### Props

| 参数 | 说明 | 类型 | 默认值 |
|------|------|------|------|
| preLoad | 提前多少屏幕宽高加载 | `Number` | `2` |
| height | 填充高度 | `Number` | `500` |
| width | 填充宽度 | `Number` | - |
| perchClass | 默认填充div的class | `String` `Object` | - |
| type | 懒加载组件的层级或者类别 | `String` `Number` | `0` |
| noRecycle | 是否禁止组件DOM回收 | `Boolean` | `false` |
| loading | 加载状态，`true`为加载中，不渲染组件，显示填充内容 | `Boolean` | `false` |
| exposureData | 曝光埋点相关的数据 | `Object` | - |
| filterTexts | 筛选器文案数组 | `Array` | - |

### Slots

| 名称 | 说明 |
|------|------|
| skeleton | 填充内容 |

### Events

| 事件名 | 说明 | 回调参数 |
|------|------|------|
| show | 开始渲染时触发 | `vm` |
| recycle | dom回收时触发 | `vm` |

### 预览地址：
[https://cdn.wanwudezhi.com/static/material/assets/@wanwu/base-vue-lazy-component/2.1.18/index.html](https://cdn.wanwudezhi.com/static/material/assets/@wanwu/base-vue-lazy-component/2.1.18/index.html)

### CHANGELOG
0628-锦阳
1. 迁移到组件管理平台项目，编写demo
2. 修复加载bug
