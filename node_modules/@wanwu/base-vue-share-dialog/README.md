# share-dialog 分享弹窗

### 引入

``` javascript
import Vue from 'vue';
import shareDialog from '@wanwu/base-vue-share-dialog'
Vue.use(shareDialog)
```

### 导出
``` javascript

export {
    shareDialogDefaultProps,
    getShortChain,
    shareDialog
};
export default comp;

```
## 代码演示

### 方法调用

 
``` html
<template>
    <div
        class="shareBtn flex f-ai-c f-jc-c"
        @click="showShare"
    >
        点击打开弹窗
    </div>
</template>

<script>
    import {
        shareDialog,
    } from '../../../src/index.js';
    export default {
        name: 'Demo',
        components: {},
        data() {
            return {
                config: {
                    width: 580,
                    height: 1000,
                    canvasConfig: [
                        {
                            image: "https://cdn.wanwudezhi.com/seller-admin/image/MTU5MTI1NzA1OTI3NjI3OTE5NA==.jpg",
                            position: [0, 0],
                            size: [580, 1000],
                        },
                        {
                            image: "https://cdn.wanwudezhi.com/seller-admin/image/MTU1MjYzMTI5ODU3MQ==.png",
                            backgroundColor: "#fff",
                            position: [30, 28],
                            size: [88, 88],
                            borderRadius: 44,
                            padding: 4,
                        },
                        {
                            text: "JYC",
                            color: "#000",
                            position: [138, 40],
                            fontSize: 28,
                        },
                        {
                            image: "https://cdn.wanwudezhi.com/static/web-static/image/5ddd97609e861f5f3c6142b874c875cd_196x196.png",
                            position: [40, 780],
                            size: [160, 160],
                        },
                    ],
                },
            };
        },
        methods: {
            // 注意：initCanvasConfig变化会导致图片重绘，所以最好这个方法是一个固定的变量
            async   initCanvasConfig() {
                return this.config;
            },
            showShare() {
                shareDialog.showShare({
                    props: {
                        initCanvasConfig: this.initCanvasConfig,
                    },
                    events: {
                        closed() {
                            this.$toast('弹窗关闭了');
                        },
                        shareComplete(action) {
                            this.$dialog.alert(`触发了---${action}`);
                        },
                    },
                });
            },
        },
    };
</script>
<style lang="less" scoped>
.shareBtn {
    padding: 30px;
    border-radius: 10px;
    background-color: #ea393c;
    color: #fff;
    font-weight: bold;
}
</style>

```
### 组件调用

 
``` html
<template>
    <div class="demo">
        <div
            class="shareBtn flex f-ai-c f-jc-c"
            @click="showShare"
        >
            点击打开弹窗
        </div>
        <shareDialog
            v-model="value"
            :init-canvas-config="initCanvasConfig"
            class="shareDialog"
            show-top-share-img
            @closed="onClosed"
            @shareComplete="onShareComplete"
        ></shareDialog>
    </div>
</template>

<script>
    import shareDialog from '../../../src/index.js';
    export default {
        name: 'Demo',
        components: {
            shareDialog,
        },
        data() {
            return {
                value: false,
                config: {
                    width: 580,
                    height: 1000,
                    canvasConfig: [
                        {
                            image: "https://cdn.wanwudezhi.com/seller-admin/image/MTU5MTI1NzA1OTI3NjI3OTE5NA==.jpg",
                            position: [0, 0],
                            size: [580, 1000],
                        },
                        {
                            image: "https://cdn.wanwudezhi.com/seller-admin/image/MTU1MjYzMTI5ODU3MQ==.png",
                            backgroundColor: "#fff",
                            position: [30, 28],
                            size: [88, 88],
                            borderRadius: 44,
                            padding: 4,
                        },
                        {
                            text: "JYC",
                            color: "#000",
                            position: [138, 40],
                            fontSize: 28,
                        },
                        {
                            image: "https://cdn.wanwudezhi.com/static/web-static/image/5ddd97609e861f5f3c6142b874c875cd_196x196.png",
                            position: [40, 780],
                            size: [160, 160],
                        },
                    ],
                },
            };
        },
        methods: {
            async   initCanvasConfig() {
                return this.config;
            },
            onClosed() {
                this.$toast('弹窗关闭了');
            },
            onShareComplete(action) {
                this.$dialog.alert(`触发了---${action}`);
            },
            showShare() {
                this.value = true;
            },
        },
    };
</script>
<style lang="less" scoped>
.shareBtn {
    padding: 30px;
    border-radius: 10px;
    background-color: #ea393c;
    color: #fff;
    font-weight: bold;
}
</style>

```


## 组件文档

### Props

|Name|Description|Type|Required|Default|
|---|---|---|---|---|
|imageWitdh|分享海报的宽度|`Number`|`false`|-|
|initCanvasConfig|Promise Function resolve canvasConfig<br/> 对应的canvasConfig规则可以参考<br/>canvas2image的文档<br/> http://fe-material.wanwudezhi.work/?key=2&keypath=2-4<br/> 或者 http://npm.wanwudezhi.com/package/@wanwu/canvas2image<br/>|`Function`|`false`|`{wxim: 4,yjfq: ua.isApp() && 4, copy: true, saveImg: true,qq: ua.isApp() && fn.compareVersion(ua.getAppVersion(), '2.5.1') >= 0, wb: ua.isApp() && fn.compareVersion(ua.getAppVersion(), '2.5.1') >= 0,  }`|
|value|弹窗显示隐藏|`Boolean`|`false`|-|
|showBtn|底部分享按钮，一共支持这几个key：<br/> wxim(分享好友)<br/> yjfq(一键发圈)<br/> qq(分享到QQ)<br/> wb(分享到微博)<br/> hbfq(多图发圈，特定场景，一般没用)<br/> saveImg(保存图片)<br/> copy(复制链接--默认复制 `标题加链接`) **每一个key的值可以是`boolean`，true展示该按钮，false隐藏，如果是微信分享相关的，可以支持接受number类型的值**<br/> 对应的类型来自于微信开放文档的mediaType<br/> mediaType 0 文字类型 1 图片类型 2 音乐类型 3 视频类型 4 网页类型 5 小程序类型<br/> 可以查看文档的**PluginShare - wechat**相关内容 http://wiki.wanwudezhi.work/pages/viewpage.action?pageId=329065<br/>分享相关的所有功能，除了复制链接，其他功能只支持app内使用 |`Object`|`false`|-|
|showTopShareImg|是否展示顶部海报图片|`Boolean`|`false`|-|
|shareObj|分享配置对象，相关配置可以查看@wanwu/base-share<br/> http://npm.wanwudezhi.com/package/@wanwu/base-share<br/> 未完成，待补充<br/>|`Object`|`false`|-|
|extraParams|额外参数（社区用的，一般不建议使用）<br/> `Function` extraParams.emitEventsFn 用户点击底部按钮后触发，触发时机和`shareComplete`事件一样，建议使用shareComplete<br/> `string|number` extraParams.shareWayVal 用户点击底部分享按钮后上报埋点参数（shareWay）<br/> `Object` extraParams.shareExtra 小程序分享参数，小程序/webview/share页面接收的参数，只有shareTaskType<br/> `string` extraParams.shareExtra.shareTaskType 小程序分享参数，小程序/webview/share页面接收的参数<br/>|`Object`|`false`|-|
|tipText|引导提示的文案|`String`|`false`|-|
|tipImg|引导提示对应的背景图片<br/> {string} url 图片链接<br/> {number} width 图片宽度<br/> {number}  height 图片高度<br/>|`Object`|`false`|-|
|showTip|是否展示引导提示|`Boolean`|`false`|`{url: 'https://cdn.wanwudezhi.com/static/web-static/image/5c0d3a7d8f2e982b000cba89ca38555b_750x80.png',width: 750,height: 80}`|

### Event

|Event Name|Description|Parameters|
|---|---|---|
|closed|弹窗关闭动画结束后|-|
|input|弹窗显示隐藏状态修改，配合value实现v-module|{boolean} value 弹窗显示隐藏状态|
|shareComplete|用户点击底部分享按钮后触发|{string} action 用户点击的分享按钮类型|

### Slot

|Name|Description|Default Slot Content|
|---|---|---|
|shareTip|引导分享提示,默认`showTip`=true时展示tipImg为背景，tipText为文案的一个引导提示|-|

## js调用分享弹窗

* [@wanwu/base-vue-share-dialog](#module_@wanwu/base-vue-share-dialog)
    * [.shareDialog](#module_@wanwu/base-vue-share-dialog..ShareDialog)
        * [.showShare(options)](#module_@wanwu/base-vue-share-dialog..ShareDialog+showShare)
        * [.close()](#module_@wanwu/base-vue-share-dialog..ShareDialog+close)
        * [.remove()](#module_@wanwu/base-vue-share-dialog..ShareDialog+remove)
        * [.drawImg(config)](#module_@wanwu/base-vue-share-dialog..ShareDialog+drawImg) ⇒ <code>Promise.&lt;string&gt;</code>
        * [.downloadImageByHdp(image)](#module_@wanwu/base-vue-share-dialog..ShareDialog+downloadImageByHdp) ⇒ <code>Promise</code>
        * [.show(initCanvasConfig, showBtn, showTopShareImg, shareObj, events, imageWitdh, extraParams, showTip, tipText)](#module_@wanwu/base-vue-share-dialog..ShareDialog+show)

#### shareDialog.showShare(options)
js调用分享弹窗 shareDialog

**Kind**: instance method of [<code>ShareDialog</code>](#module_@wanwu/base-vue-share-dialog..ShareDialog)

showShare的options都是基于组件的props和events的，也就是，方法调用弹窗，完整实现了组件调用的属性传入和事件机制，所以，具体文档建议查看上文的组件文档

| Param | Type | Description |
| --- | --- | --- |
| options | <code>Object</code> | options可以直接是shareDialog的props，也可以是{props,events}的结构 |
| options.props | <code>Object</code> | shareDialog组件的props |
| options.events | <code>Object</code> | shareDialog组件的events |

<a name="module_@wanwu/base-vue-share-dialog..ShareDialog+close"></a>

#### shareDialog.close()
关闭分享弹窗

**Kind**: instance method of [<code>ShareDialog</code>](#module_@wanwu/base-vue-share-dialog..ShareDialog)
<a name="module_@wanwu/base-vue-share-dialog..ShareDialog+remove"></a>

#### shareDialog.remove()
删除分享弹窗组件实例和dom节点

**Kind**: instance method of [<code>ShareDialog</code>](#module_@wanwu/base-vue-share-dialog..ShareDialog)
<a name="module_@wanwu/base-vue-share-dialog..ShareDialog+drawImg"></a>

#### shareDialog.drawImg(config) ⇒ <code>Promise.&lt;string&gt;</code>
绘制分享海报

**Kind**: instance method of [<code>ShareDialog</code>](#module_@wanwu/base-vue-share-dialog..ShareDialog)

| Param | Type | Description |
| --- | --- | --- |
| config | <code>Object</code> | 画图配置 |
| config.canvasConfig | <code>Object</code> | canvas2image配置 文档查询：http://npm.wanwudezhi.com/package/@wanwu/canvas2image |
| config.width | <code>number</code> | canvas画布宽度 |
| config.height | <code>number</code> | canvas画布高度 |

<a name="module_@wanwu/base-vue-share-dialog..ShareDialog+downloadImageByHdp"></a>

#### shareDialog.downloadImageByHdp(image) ⇒ <code>Promise</code>
保存图片

**Kind**: instance method of [<code>ShareDialog</code>](#module_@wanwu/base-vue-share-dialog..ShareDialog)

| Param | Type | Description |
| --- | --- | --- |
| image | <code>string</code> | 图片地址或base64 |

<a name="module_@wanwu/base-vue-share-dialog..ShareDialog+show"></a>

#### shareDialog.show(initCanvasConfig, showBtn, showTopShareImg, shareObj, events, imageWitdh, extraParams, showTip, tipText)
js调用分享弹窗 shareDialog(旧方法不推荐使用)

**Kind**: instance method of [<code>ShareDialog</code>](#module_@wanwu/base-vue-share-dialog..ShareDialog)

| Param | Type | Description |
| --- | --- | --- |
| initCanvasConfig | <code>function</code> | canvas图片配置函数，返回Promise对象 |
| showBtn | <code>Object</code> \| <code>Number</code> | 底部操作按钮 |
| showTopShareImg | <code>boolean</code> | 顶部分享图片 |
| shareObj | <code>Object</code> | 分现到微信的配置参数 |
| events | <code>Object</code> | 订阅事件 |
| imageWitdh | <code>number</code> | 顶部分享图片宽度 |
| extraParams | <code>Object</code> | 额外的处理参数，通过该组件的$emit暴露出去（这里是为了应对多个弹窗实例缓存的数据不实时问题） |
| showTip | <code>boolean</code> | 是否显示引导提示 |
| tipText | <code>string</code> | 引导提示文案 |





### 预览地址：
[https://cdn.wanwudezhi.com/static/material/assets/@wanwu/base-vue-share-dialog/2.1.27/index.html](https://cdn.wanwudezhi.com/static/material/assets/@wanwu/base-vue-share-dialog/2.1.27/index.html)

### CHANGELOG
+ 日期：2020.08.07
+ 作者：锦阳
+ 内容：
    - 分享弹窗迁移
    - 注释、文档完善
